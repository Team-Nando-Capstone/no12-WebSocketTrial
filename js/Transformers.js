/* TRANSFORMERS DATA CONTROL
   This file is used to control the transformers' data show in the databox in the left hand side.
 */
var U_Tr999; var P_Tr999; var Q_Tr999;
var U_Tr651; var P_Tr651; var Q_Tr651;
var U_Tr652; var P_Tr652; var Q_Tr652;
var U_Tr653; var P_Tr653; var Q_Tr653;
var U_Tr654; var P_Tr654; var Q_Tr654;
var U_Tr655; var P_Tr655; var Q_Tr655;
var U_Tr656; var P_Tr656; var Q_Tr656;
var U_Tr657; var P_Tr657; var Q_Tr657;
var U_Tr658; var P_Tr658; var Q_Tr658;
var U_Tr659; var P_Tr659; var Q_Tr659;
var U_Tr660; var P_Tr660; var Q_Tr660;
var U_Tr661; var P_Tr661; var Q_Tr661;
var U_Tr662; var P_Tr662; var Q_Tr662;
var U_Tr663; var P_Tr663; var Q_Tr663;
var U_Tr664; var P_Tr664; var Q_Tr664;
var U_Tr665; var P_Tr665; var Q_Tr665;
var U_Tr666; var P_Tr666; var Q_Tr666;
var U_Tr667; var P_Tr667; var Q_Tr667;
var U_Tr668; var P_Tr668; var Q_Tr668;
var U_Tr669; var P_Tr669; var Q_Tr669;
var U_Tr670; var P_Tr670; var Q_Tr670;
var U_Tr671; var P_Tr671; var Q_Tr671;
var U_Tr672; var P_Tr672; var Q_Tr672;
var U_Tr673; var P_Tr673; var Q_Tr673;
var U_Tr674; var P_Tr674; var Q_Tr674;
var U_Tr675; var P_Tr675; var Q_Tr675;
var U_Tr676; var P_Tr676; var Q_Tr676;
var U_Tr677; var P_Tr677; var Q_Tr677;
var U_Tr678; var P_Tr678; var Q_Tr678;
var U_Tr679; var P_Tr679; var Q_Tr679;
var U_Tr680; var P_Tr680; var Q_Tr680;
var U_Tr681; var P_Tr681; var Q_Tr681;
var U_Tr682; var P_Tr682; var Q_Tr682;
var U_Tr683; var P_Tr683; var Q_Tr683;
var U_Tr684; var P_Tr684; var Q_Tr684;
var U_Tr685; var P_Tr685; var Q_Tr685;
var U_Tr686; var P_Tr686; var Q_Tr686;
var U_Tr687; var P_Tr687; var Q_Tr687;
var U_Tr688; var P_Tr688; var Q_Tr688;
var U_Tr689; var P_Tr689; var Q_Tr689;
var U_Tr690; var P_Tr690; var Q_Tr690;
var U_Tr691; var P_Tr691; var Q_Tr691;
var U_Tr692; var P_Tr692; var Q_Tr692;
var U_Tr693; var P_Tr693; var Q_Tr693;
var U_Tr694; var P_Tr694; var Q_Tr694;
var U_Tr695; var P_Tr695; var Q_Tr695;
var U_Tr696; var P_Tr696; var Q_Tr696;
var U_Tr697; var P_Tr697; var Q_Tr697;
var U_Tr698; var P_Tr698; var Q_Tr698;
var U_Tr699; var P_Tr699; var Q_Tr699;
var U_Tr700; var P_Tr700; var Q_Tr700;
var U_Tr701; var P_Tr701; var Q_Tr701;
var U_Tr702; var P_Tr702; var Q_Tr702;
var U_Tr703; var P_Tr703; var Q_Tr703;
var U_Tr704; var P_Tr704; var Q_Tr704;
var U_Tr705; var P_Tr705; var Q_Tr705;
var U_Tr706; var P_Tr706; var Q_Tr706;
var U_Tr707; var P_Tr707; var Q_Tr707;
var U_Tr708; var P_Tr708; var Q_Tr708;
var U_Tr709; var P_Tr709; var Q_Tr709;
var U_Tr710; var P_Tr710; var Q_Tr710;
var U_Tr711; var P_Tr711; var Q_Tr711;
var U_Tr712; var P_Tr712; var Q_Tr712;
var U_Tr713; var P_Tr713; var Q_Tr713;
var U_Tr714; var P_Tr714; var Q_Tr714;
var U_Tr715; var P_Tr715; var Q_Tr715;
var U_Tr716; var P_Tr716; var Q_Tr716;
var U_Tr717; var P_Tr717; var Q_Tr717;
var U_Tr718; var P_Tr718; var Q_Tr718;
var U_Tr719; var P_Tr719; var Q_Tr719;
var U_Tr720; var P_Tr720; var Q_Tr720;
var U_Tr721; var P_Tr721; var Q_Tr721;
var U_Tr722; var P_Tr722; var Q_Tr722;
var U_Tr723; var P_Tr723; var Q_Tr723;
var U_Tr724; var P_Tr724; var Q_Tr724;
var U_Tr725; var P_Tr725; var Q_Tr725;
var U_Tr726; var P_Tr726; var Q_Tr726;
var U_Tr727; var P_Tr727; var Q_Tr727;
var U_Tr728; var P_Tr728; var Q_Tr728;
var U_Tr729; var P_Tr729; var Q_Tr729;
var flag; var ElementType;

setInterval(function(){Tr_Bus_Table(flag)},1000);

Tr_Click('Tr999', 'Source', P_Tr999, Q_Tr999, U_Tr999);
Tr_Click('Tr651', '651', P_Tr651, Q_Tr651, U_Tr651);
Tr_Click('Tr652', '652', P_Tr652, Q_Tr652, U_Tr652);
Tr_Click('Tr653', '653', P_Tr653, Q_Tr653, U_Tr653);
Tr_Click('Tr654', '654', P_Tr654, Q_Tr654, U_Tr654);
Tr_Click('Tr655', '655', P_Tr655, Q_Tr655, U_Tr655);
Tr_Click('Tr656', '656', P_Tr656, Q_Tr656, U_Tr656);
Tr_Click('Tr657', '657', P_Tr657, Q_Tr657, U_Tr657);
Tr_Click('Tr658', '658', P_Tr658, Q_Tr658, U_Tr658);
Tr_Click('Tr659', '659', P_Tr659, Q_Tr659, U_Tr659);
Tr_Click('Tr660', '660', P_Tr660, Q_Tr660, U_Tr660);
Tr_Click('Tr661', '661', P_Tr661, Q_Tr661, U_Tr661);
Tr_Click('Tr662', '662', P_Tr662, Q_Tr662, U_Tr662);
Tr_Click('Tr663', '663', P_Tr663, Q_Tr663, U_Tr663);
Tr_Click('Tr664', '664', P_Tr664, Q_Tr664, U_Tr664);
Tr_Click('Tr665', '665', P_Tr665, Q_Tr665, U_Tr665);
Tr_Click('Tr666', '666', P_Tr666, Q_Tr666, U_Tr666);
Tr_Click('Tr667', '667', P_Tr667, Q_Tr667, U_Tr667);
Tr_Click('Tr668', '668', P_Tr668, Q_Tr668, U_Tr668);
Tr_Click('Tr669', '669', P_Tr669, Q_Tr669, U_Tr669);
Tr_Click('Tr670', '670', P_Tr670, Q_Tr670, U_Tr670);
Tr_Click('Tr671', '671', P_Tr671, Q_Tr671, U_Tr671);
Tr_Click('Tr672', '672', P_Tr672, Q_Tr672, U_Tr672);
Tr_Click('Tr673', '673', P_Tr673, Q_Tr673, U_Tr673);
Tr_Click('Tr674', '674', P_Tr674, Q_Tr674, U_Tr674);
Tr_Click('Tr675', '675', P_Tr675, Q_Tr675, U_Tr675);
Tr_Click('Tr676', '676', P_Tr676, Q_Tr676, U_Tr676);
Tr_Click('Tr677', '677', P_Tr677, Q_Tr677, U_Tr677);
Tr_Click('Tr678', '678', P_Tr678, Q_Tr678, U_Tr678);
Tr_Click('Tr679', '679', P_Tr679, Q_Tr679, U_Tr679);
Tr_Click('Tr680', '680', P_Tr680, Q_Tr680, U_Tr680);
Tr_Click('Tr681', '681', P_Tr681, Q_Tr681, U_Tr681);
Tr_Click('Tr682', '682', P_Tr682, Q_Tr682, U_Tr682);
Tr_Click('Tr683', '683', P_Tr683, Q_Tr683, U_Tr683);
Tr_Click('Tr684', '684', P_Tr684, Q_Tr684, U_Tr684);
Tr_Click('Tr685', '685', P_Tr685, Q_Tr685, U_Tr685);
Tr_Click('Tr686', '686', P_Tr686, Q_Tr686, U_Tr686);
Tr_Click('Tr687', '687', P_Tr687, Q_Tr687, U_Tr687);
Tr_Click('Tr688', '688', P_Tr688, Q_Tr688, U_Tr688);
Tr_Click('Tr689', '689', P_Tr689, Q_Tr689, U_Tr689);
Tr_Click('Tr690', '690', P_Tr690, Q_Tr690, U_Tr690);
Tr_Click('Tr691', '691', P_Tr691, Q_Tr691, U_Tr691);
Tr_Click('Tr692', '692', P_Tr692, Q_Tr692, U_Tr692);
Tr_Click('Tr693', '693', P_Tr693, Q_Tr693, U_Tr693);
Tr_Click('Tr694', '694', P_Tr694, Q_Tr694, U_Tr694);
Tr_Click('Tr695', '695', P_Tr695, Q_Tr695, U_Tr695);
Tr_Click('Tr696', '696', P_Tr696, Q_Tr696, U_Tr696);
Tr_Click('Tr697', '697', P_Tr697, Q_Tr697, U_Tr697);
Tr_Click('Tr698', '698', P_Tr698, Q_Tr698, U_Tr698);
Tr_Click('Tr699', '699', P_Tr699, Q_Tr699, U_Tr699);
Tr_Click('Tr700', '700', P_Tr700, Q_Tr700, U_Tr700);
Tr_Click('Tr701', '701', P_Tr701, Q_Tr701, U_Tr701);
Tr_Click('Tr702', '702', P_Tr702, Q_Tr702, U_Tr702);
Tr_Click('Tr703', '703', P_Tr703, Q_Tr703, U_Tr703);
Tr_Click('Tr704', '704', P_Tr704, Q_Tr704, U_Tr704);
Tr_Click('Tr705', '705', P_Tr705, Q_Tr705, U_Tr705);
Tr_Click('Tr706', '706', P_Tr706, Q_Tr706, U_Tr706);
Tr_Click('Tr707', '707', P_Tr707, Q_Tr707, U_Tr707);
Tr_Click('Tr708', '708', P_Tr708, Q_Tr708, U_Tr708);
Tr_Click('Tr709', '709', P_Tr709, Q_Tr709, U_Tr709);
Tr_Click('Tr710', '710', P_Tr710, Q_Tr710, U_Tr710);
Tr_Click('Tr711', '711', P_Tr711, Q_Tr711, U_Tr711);
Tr_Click('Tr712', '712', P_Tr712, Q_Tr712, U_Tr712);
Tr_Click('Tr713', '713', P_Tr713, Q_Tr713, U_Tr713);
Tr_Click('Tr714', '714', P_Tr714, Q_Tr714, U_Tr714);
Tr_Click('Tr715', '715', P_Tr715, Q_Tr715, U_Tr715);
Tr_Click('Tr716', '716', P_Tr716, Q_Tr716, U_Tr716);
Tr_Click('Tr717', '717', P_Tr717, Q_Tr717, U_Tr717);
Tr_Click('Tr718', '718', P_Tr718, Q_Tr718, U_Tr718);
Tr_Click('Tr719', '719', P_Tr719, Q_Tr719, U_Tr719);
Tr_Click('Tr720', '720', P_Tr720, Q_Tr720, U_Tr720);
Tr_Click('Tr721', '721', P_Tr721, Q_Tr721, U_Tr721);
Tr_Click('Tr722', '722', P_Tr722, Q_Tr722, U_Tr722);
Tr_Click('Tr723', '723', P_Tr723, Q_Tr723, U_Tr723);
Tr_Click('Tr724', '724', P_Tr724, Q_Tr724, U_Tr724);
Tr_Click('Tr725', '725', P_Tr725, Q_Tr725, U_Tr725);
Tr_Click('Tr726', '726', P_Tr726, Q_Tr726, U_Tr726);
Tr_Click('Tr727', '727', P_Tr727, Q_Tr727, U_Tr727);
Tr_Click('Tr728', '728', P_Tr728, Q_Tr728, U_Tr728);
Tr_Click('Tr729', '729', P_Tr729, Q_Tr729, U_Tr729);


function Tr_Bus_Table(flag){
   if (flag !== undefined){
   if (ElementType === "Tr") {
      document.getElementById('V_value').innerHTML = (parseFloat(eval("U_" + flag)) * 100).toFixed(2) + ' %';
      document.getElementById('P_value').innerHTML = eval("P_" + flag).toFixed(0) + ' kW';
      document.getElementById('Q_value').innerHTML = eval("Q_" + flag).toFixed(2) + ' kvar';
   }else if (ElementType === "Bus"){
      document.getElementById('V_value').innerHTML = eval("V_" + flag).toFixed(2) + ' p.u.';
      document.getElementById('P_value').innerHTML = eval("P_" + flag).toFixed(0) + ' kW';
      document.getElementById('Q_value').innerHTML = eval("Q_" + flag).toFixed(2) + ' kvar';
   }}
}
function Tr_Click(elementid,elementnum,P,Q,U){
   let id = elementid.toString();
   if(id !== undefined) {
      document.getElementById(id).addEventListener('click', function () {
         document.getElementById('V_value').innerHTML = (parseFloat(U) * 100).toFixed(2) + ' %';
         document.getElementById('P_value').innerHTML = parseFloat(P).toFixed(0) + ' kW';
         document.getElementById('Q_value').innerHTML = parseFloat(Q).toFixed(2) + ' kvar';
         if (elementnum === "Source"){document.getElementById('ElementID').innerHTML = elementnum;}
         else{document.getElementById('ElementID').innerHTML = 'Transformer ' + elementnum;}
         document.getElementById('SwitchableU_V').innerHTML = 'Utilization';
         flag = id;
         ElementType = "Tr";
      });
   }
}